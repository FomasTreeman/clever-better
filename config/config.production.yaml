# Production Configuration
# This configuration is for production deployments
# All sensitive values should come from AWS Secrets Manager
# Set AWS_SECRETS_ENABLED=true and AWS_SECRET_NAME environment variable

# =============================================================================
# Application Settings
# =============================================================================
app:
  name: clever-better
  environment: production
  log_level: info  # Production log level

# =============================================================================
# Database Configuration
# =============================================================================
database:
  host: ${DB_HOST}  # Set via AWS Secrets Manager
  port: 5432
  name: clever_better_prod
  user: ${DB_USER}  # Set via AWS Secrets Manager
  password: ${DB_PASSWORD}  # Set via AWS Secrets Manager
  ssl_mode: require  # SSL required for production
  max_connections: 50
  max_idle_connections: 10

# =============================================================================
# Betfair API Configuration
# =============================================================================
betfair:
  api_url: https://api.betfair.com/exchange/betting/rest/v1.0
  stream_url: stream-api.betfair.com:443
  app_key: ${BETFAIR_APP_KEY}  # Set via AWS Secrets Manager
  username: ${BETFAIR_USERNAME}  # Set via AWS Secrets Manager
  password: ${BETFAIR_PASSWORD}  # Set via AWS Secrets Manager
  cert_file: /etc/secrets/betfair/cert.pem
  key_file: /etc/secrets/betfair/key.pem

# =============================================================================
# ML Service Configuration
# =============================================================================
ml_service:
  url: https://ml-service.internal:8000
  http_address: https://ml-service.internal:8000
  grpc_address: ml-service.internal:50051
  timeout_seconds: 30
  request_timeout_seconds: 30
  retry_attempts: 3
  cache_ttl_seconds: 3600
  cache_max_size: 50000

# =============================================================================
# Trading Configuration
# =============================================================================
trading:
  # Risk Management - Production settings
  max_stake_per_bet: 50.00
  max_daily_loss: 500.00
  max_exposure: 2000.00

  # Strategy Settings
  min_confidence_threshold: 0.70
  min_expected_value: 0.05

  # Market Selection
  markets:
    - WIN
    - PLACE

  # Time Settings
  pre_race_window_minutes: 30
  min_time_to_start_seconds: 60

# =============================================================================
# Backtesting Configuration
# =============================================================================
backtest:
  start_date: "2023-01-01"
  end_date: "2024-01-01"
  initial_bankroll: 10000.00
  monte_carlo_iterations: 5000
  walk_forward_windows: 24

# =============================================================================
# Data Ingestion Configuration
# =============================================================================
data_ingestion:
  sources:
    - name: betfair_historical
      enabled: true
      batch_size: 5000
    - name: racing_post
      enabled: true
      api_key: ${RACING_POST_API_KEY}  # Set via AWS Secrets Manager

  schedule:
    historical_sync: "0 2 * * *"  # Daily at 2 AM
    live_polling_interval_seconds: 5

# =============================================================================
# Metrics and Monitoring
# =============================================================================
metrics:
  enabled: true
  port: 9090
  path: /metrics

# =============================================================================
# Feature Flags
# =============================================================================
features:
  live_trading_enabled: true
  paper_trading_enabled: false
  ml_predictions_enabled: true
  advanced_analytics_enabled: false
